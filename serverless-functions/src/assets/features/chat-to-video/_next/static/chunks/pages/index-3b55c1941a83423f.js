(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(70439)}])},70439:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return R}});var i=n(85893),o=n(9008),c=n.n(o),r=n(11163),a=n(67063),s=n(67294),l=n(41635),d=n(65351),h=n(96334),u=n(55018),p=n(36562),x=n(50686),g=x.iK.div((0,x.iv)({paddingX:"space40",paddingTop:"space200",paddingBottom:"space60",width:"100%",minHeight:"100vh",justifyContent:"center",flexDirection:"column",backgroundColor:"colorBackground",alignItems:"center",alignContent:"center",horizontalAlign:"center"})),m=x.iK.div((0,x.iv)({bottom:40,opacity:.8,padding:"space20",backgroundColor:"#000000",zIndex:100})),f=x.iK.div((0,x.iv)({width:"100%",justifyContent:"center",alignContent:"center",testAlign:"center",position:"relative",top:0,left:0,backgroundColor:"colorBackgroundPrimary",minHeight:"100%"})),v=x.iK.div((0,x.iv)({})),j=x.iK.div((0,x.iv)({width:"100%",height:"70px",marginTop:"space80"})),k=x.iK.div((0,x.iv)({maxWidth:"500px",marginTop:"space40",minWidth:"300px",justifyContent:"center"}));function y(){var e=(0,r.useRouter)(),t=(0,s.useState)(""),n=t[0],o=t[1];return(0,i.jsx)(g,{children:(0,i.jsxs)(d.Flex,{hAlignContent:"center",vertical:!0,vAlignContent:"center",height:"100%",children:[(0,i.jsxs)(p.MediaObject,{as:"div",verticalAlign:"center",marginBottom:"space40",children:[(0,i.jsx)(p.MediaFigure,{as:"div",spacing:"space40",children:(0,i.jsx)("img",{src:"https://hosted-assets-2838-dev.twil.io/twilio.png",height:"40px"})}),(0,i.jsx)(p.MediaBody,{as:"div",children:(0,i.jsx)(l.Text,{as:"p",fontSize:"fontSize70",fontWeight:"fontWeightMedium",children:"Twilio Video Quickstart Lite"})})]}),(0,i.jsx)(k,{children:(0,i.jsxs)(h.Card,{children:[(0,i.jsx)(u.Heading,{as:"h4",variant:"heading40",children:"Welcome!"}),(0,i.jsxs)(l.Text,{as:"p",fontSize:"fontSize20",fontWeight:"fontWeightMedium",color:"colorText",children:["This quickstart application aims at getting you stood up rapidly with a React-powered web application, powered by"," ",(0,i.jsx)("a",{href:"https://www.twilio.com/docs/video/javascript",target:"_blank",rel:"noopener",children:"Twilio Video JS"}),"."]}),(0,i.jsxs)(d.Flex,{marginTop:"space40",vertical:!0,children:[(0,i.jsx)(p.Label,{htmlFor:"video_room_name",required:!0,children:"Video Room Name"}),(0,i.jsx)(p.Input,{"aria-describedby":"email_help_text",id:"video_room_name",name:"video_room_name",placeholder:"ex. 123456",type:"text",required:!0,onChange:function(e){return o(e.target.value)}}),(0,i.jsx)(p.HelpText,{id:"email_help_text",children:"To join a video room manually, please enter the room name."}),(0,i.jsx)(d.Flex,{marginTop:"space40",children:(0,i.jsx)(p.Button,{type:"submit",variant:"destructive",onClick:function(){console.log(n),n&&e.push("/?code=".concat(n))},style:{background:"#F22F46"},disabled:!n,children:"Next"})})]})]})})]})})}var w=n(47568),C=n(34051),b=n.n(C),S=n(34929),T=n(98445),B=n(63750),z=n(37106),F=n(80471);function W(e,t){e.forEach((function(e){var n;if(e.track&&(e=e.track),e.attach){var i=e.attach();i.style.width="100%",i.style.height="100%",null===(n=document.getElementById(t))||void 0===n||n.appendChild(i)}}))}var M=x.iK.div((0,x.iv)({paddingX:"space40",paddingTop:"space200",paddingBottom:"space60",width:"100%",minHeight:"100vh",justifyContent:"center",flexDirection:"column",backgroundColor:"colorBackground",alignItems:"center",alignContent:"center",horizontalAlign:"center"})),A=x.iK.div((0,x.iv)({maxWidth:"500px",marginTop:"space40"}));function _(){return(0,i.jsx)(M,{children:(0,i.jsxs)(d.Flex,{hAlignContent:"center",vertical:!0,vAlignContent:"center",height:"100%",children:[(0,i.jsxs)(p.MediaObject,{as:"div",verticalAlign:"center",marginBottom:"space40",children:[(0,i.jsx)(p.MediaFigure,{as:"div",spacing:"space40",children:(0,i.jsx)("img",{src:"https://hosted-assets-2838-dev.twil.io/twilio.png",height:"40px"})}),(0,i.jsx)(p.MediaBody,{as:"div",children:(0,i.jsx)(l.Text,{as:"p",fontSize:"fontSize70",fontWeight:"fontWeightMedium",children:"Post Video Room"})})]}),(0,i.jsx)(A,{children:(0,i.jsxs)(h.Card,{children:[(0,i.jsx)(u.Heading,{as:"h4",variant:"heading40",children:"You video call has completed."}),(0,i.jsx)(l.Text,{as:"p",fontSize:"fontSize20",fontWeight:"fontWeightMedium",color:"colorText",children:"This view can be used to collect post video call CSAT or other data capture."})]})})]})})}var E="https://custom-flex-extensions-serverless-7569-dev.twil.io";function V(){var e=function(e){console.log("Successfully joined a Room: ".concat(e));var t=e.localParticipant;console.log('Connected to the Room as LocalParticipant "'.concat(t.identity,'"')),e.localParticipant.on("trackEnabled",(function(e){console.log("enabled",e)})),e.localParticipant.on("trackDisabled",(function(e){console.log("disabled",e)}));var n="remote-media-div";!function(e,t){e.forEach((function(e){var n;e.track&&(e=e.track);var i=e.attach();i.style.maxWidth="100%",i.style.height="100%",null===(n=document.getElementById(t))||void 0===n||n.appendChild(i)}))}(Array.from(t.tracks.values()),"local-media-div"),e.participants.forEach((function(e){console.log("IncomingVideoComponent: ".concat(e.identity," is already in the room}")),W(Array.from(e.tracks.values()),n)})),e.on("participantConnected",(function(e){console.log("IncomingVideoComponent: ".concat(e.identity," joined the room}"))})),e.on("trackSubscribed",(function(e,t){console.log("IncomingVideoComponent: ".concat(t," added track: ").concat(e.kind)),W([e],n)})),e.on("trackUnsubscribed",(function(e,t){console.log("IncomingVideoComponent: ".concat(t," removed track: ").concat(e.kind)),function(e){e.forEach((function(e){e.track&&(e=e.track),e.detach&&e.detach().forEach((function(e){e.remove()}))}))}([e])})),e.on("participantDisconnected",(function(e){console.log("IncomingVideoComponent: ".concat(e.identity," left the room"))})),e.on("disconnected",(function(){console.log("IncomingVideoComponent: disconnected")}))},t=(0,r.useRouter)().query.code,n=(0,s.useState)(!1),o=n[0],c=n[1],a=(0,s.useState)(!1),h=a[0],u=a[1],x=(0,s.useState)(null),y=x[0],C=x[1],M=(0,s.useState)(null),A=M[0],V=M[1],R=(0,s.useState)(!0),I=R[0],P=R[1],D=(0,s.useState)(!0),H=D[0],K=D[1],L=(0,s.useState)(null),N=L[0],O=L[1],U=(0,s.useState)(null),q=U[0],X=U[1],Z=(0,s.useState)("Join Video Room"),J=Z[0],Q=Z[1],G=(0,s.useState)(!1),Y=G[0],$=G[1],ee=(0,s.useState)(!1),te=ee[0],ne=ee[1],ie=(0,s.useState)(""),oe=ie[0],ce=ie[1];function re(e){return ae.apply(this,arguments)}function ae(){return(ae=(0,w.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q||!t.room){e.next=5;break}return e.next=3,de();case 3:e.next=6;break;case 5:ne(!0);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e){return le.apply(this,arguments)}function le(){return le=(0,w.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ce(""),e.next=3,fetch("".concat(E,"/features/chat-to-video-escalation/client-get-sync-token?code=").concat(t)).then((function(e){return e.json()})).then((function(e){if(e.error)throw e.error;return new S.Qh(e.token)})).then((function(e){return e.document(t)})).then((function(e){console.log("Code Validated. Sync document SID:",e.sid),re(e.data),e.on("updated",(function(e){console.log('Received an "updated" Sync Document event: ',e),$(!0),Q("Join Video Room"),re(e.data)}))})).catch((function(e){console.error("Unexpected error",e),ce(e),c(!1)}));case 3:case"end":return e.stop()}}),e)}))),le.apply(this,arguments)}function de(){return he.apply(this,arguments)}function he(){return(he=(0,w.Z)(b().mark((function n(){return b().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat(E,"/features/chat-to-video-escalation/client-get-video-token?code=").concat(t)).then((function(e){return e.json()})).then((function(e){if(e.error)throw e.error;return console.log(e),T.connect(e.token)})).then((function(t){return c(!1),Q("Connected!"),X(t),Array.from(t.localParticipant.tracks.values()).forEach((function(e){"audio"===e.kind?(C(e.track),P(e.track.isEnabled)):(V(e.track),K(e.track.isEnabled))})),e(t),t}),(function(e){console.error("Unable to connect to Room: ".concat(e.message)),alert("Unable to connect to Room: ".concat(e.message))})).catch((function(e){console.error("Unexpected error",e),alert("Unexpected error: ".concat(e))}));case 2:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function ue(){return pe.apply(this,arguments)}function pe(){return(pe=(0,w.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.next=3,se(t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,i.jsx)(i.Fragment,{children:q?(0,i.jsxs)(d.Flex,{vertical:!0,width:"100%",hAlignContent:"center",children:[(0,i.jsxs)(p.MediaObject,{as:"div",verticalAlign:"center",marginBottom:"space60",marginTop:"space60",children:[(0,i.jsx)(p.MediaFigure,{as:"div",spacing:"space40",children:(0,i.jsx)("img",{src:"https://hosted-assets-2838-dev.twil.io/twilio.png",height:"40px"})}),(0,i.jsx)(p.MediaBody,{as:"div",children:(0,i.jsxs)(l.Text,{as:"p",fontSize:"fontSize70",fontWeight:"fontWeightMedium",children:["Video Room - ",t]})})]}),(0,i.jsxs)(p.Grid,{padding:"space10",gutter:["space20","space60","space90"],vertical:[!0,!0,!1],children:[(0,i.jsx)(p.Column,{width:"100%",height:"auto",children:(0,i.jsxs)(v,{children:[(0,i.jsx)(f,{id:"remote-media-div"}),(0,i.jsx)(m,{children:(0,i.jsx)(l.Text,{as:"p",fontWeight:"fontWeightMedium",color:"colorTextBrandHighlight",children:"Remote Participant"})})]})}),(0,i.jsx)(p.Column,{width:"100%",children:(0,i.jsxs)(v,{children:[(0,i.jsx)(f,{id:"local-media-div"}),(0,i.jsx)(m,{children:(0,i.jsx)(l.Text,{as:"p",fontWeight:"fontWeightMedium",color:"colorTextBrandHighlight",children:"Local Participant (you)"})})]})})]}),(0,i.jsx)(j,{children:(0,i.jsx)(d.Flex,{width:"100%",hAlignContent:"center",vAlignContent:"center",children:(0,i.jsxs)(p.Stack,{orientation:"horizontal",spacing:"space50",children:[(0,i.jsx)(d.Flex,{children:I?(0,i.jsx)("div",{children:(0,i.jsx)(p.Tooltip,{text:"Mute",placement:"bottom",children:(0,i.jsx)(p.Button,{variant:"secondary",size:"circle",onClick:function(){console.log("mute clicked"),y&&(y.disable(),P(!1))},children:(0,i.jsx)(B.OnQ,{style:{width:"25px",height:"25px"}})})})}):(0,i.jsx)("div",{children:(0,i.jsx)(p.Tooltip,{text:"Unmute",placement:"bottom",children:(0,i.jsx)(p.Button,{variant:"primary",size:"circle",onClick:function(){console.log("unmute clicked"),null===y||void 0===y||y.enable(),P(!0)},children:(0,i.jsx)(B.C4C,{style:{width:"25px",height:"25px"}})})})})}),(0,i.jsx)(d.Flex,{children:H?(0,i.jsx)("div",{children:(0,i.jsx)(p.Tooltip,{text:"Stop Camera",placement:"bottom",children:(0,i.jsx)(p.Button,{variant:"secondary",size:"circle",onClick:function(){A&&(null===A||void 0===A||A.disable(),K(!1))},children:(0,i.jsx)(B.LsT,{style:{width:"25px",height:"25px"}})})})}):(0,i.jsx)("div",{children:(0,i.jsx)(p.Tooltip,{text:"Start Camera",placement:"bottom",children:(0,i.jsx)(p.Button,{variant:"primary",size:"circle",onClick:function(){A&&(A.enable(),K(!0))},children:(0,i.jsx)(B.kwV,{style:{width:"25px",height:"25px"}})})})})}),(0,i.jsx)(d.Flex,{children:(0,i.jsx)("div",{children:(0,i.jsx)(p.Tooltip,{text:N?"Stop Sharing Screen":"Share Screen",placement:"bottom",children:(0,i.jsx)(p.Button,{variant:N?"primary":"secondary",size:"circle",onClick:function(){N?(null===q||void 0===q||q.localParticipant.unpublishTrack(N),N.stop(),O(null)):navigator.mediaDevices.getDisplayMedia().then((function(e){var t=new T.LocalVideoTrack(e.getTracks()[0]);null===q||void 0===q||q.localParticipant.publishTrack(t),O(t)})).catch((function(){alert("Could not share the screen.")}))},children:N?(0,i.jsx)(z.tIC,{style:{width:"25px",height:"25px"}}):(0,i.jsx)(z.BfX,{style:{width:"25px",height:"25px"}})})})})}),(0,i.jsx)(d.Flex,{children:(0,i.jsx)("div",{children:(0,i.jsx)(p.Tooltip,{text:"Disconnect",placement:"bottom",children:(0,i.jsx)(p.Button,{variant:"primary",size:"circle",onClick:function(){q&&(q.disconnect(),X(null),u(!0))},children:(0,i.jsx)(F.Fk5,{style:{width:"25px",height:"25px"}})})})})})]})})})]}):(0,i.jsx)(i.Fragment,{children:h?(0,i.jsx)(_,{}):(0,i.jsx)(g,{children:(0,i.jsxs)(d.Flex,{hAlignContent:"center",vertical:!0,vAlignContent:"center",height:"100%",children:[(0,i.jsxs)(p.MediaObject,{as:"div",verticalAlign:"center",marginBottom:"space40",children:[(0,i.jsx)(p.MediaFigure,{as:"div",spacing:"space40",children:(0,i.jsx)("img",{src:"https://hosted-assets-2838-dev.twil.io/twilio.png",height:"40px"})}),(0,i.jsx)(p.MediaBody,{as:"div",children:(0,i.jsxs)(l.Text,{as:"p",fontSize:"fontSize70",fontWeight:"fontWeightMedium",children:["Video Room - ",t]})})]}),(0,i.jsx)(k,{children:(0,i.jsx)(p.Card,{padding:"space100",children:(0,i.jsxs)(d.Flex,{vertical:!0,hAlignContent:"center",children:[te&&(0,i.jsx)(d.Flex,{marginBottom:"space60",children:(0,i.jsx)(l.Text,{as:"p",fontSize:"fontSize60",fontWeight:"fontWeightMedium",color:"colorText",children:Y?"Agent connected.":"Waiting for agent to join..."})}),oe&&(0,i.jsx)(d.Flex,{marginBottom:"space60",children:(0,i.jsxs)(l.Text,{as:"p",fontSize:"fontSize60",fontWeight:"fontWeightMedium",color:"colorTextError",children:["Error: ",oe]})}),(0,i.jsx)(p.Button,{variant:"destructive",onClick:(0,w.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),loading:o,style:{background:"#F22F46"},children:J}),(0,i.jsx)("span",{style:{color:"#000000",lineHeight:1,fontSize:"12px",letterSpacing:"wider",marginTop:"15px",textAlign:"center"},children:"Click to join the video room!"})]})})})]})})})})}var R=function(){var e=(0,r.useRouter)().query.code;return console.log("code",e),(0,i.jsxs)(a.Box,{as:"main",children:[(0,i.jsxs)(c(),{children:[(0,i.jsx)("title",{children:"Twilio Video Lite"}),(0,i.jsx)("link",{rel:"icon",href:"https://hosted-assets-2838-dev.twil.io/twilio.png"})]}),e?(0,i.jsx)(V,{}):(0,i.jsx)(y,{})]})}}},function(e){e.O(0,[816,907,955,13,422,530,774,888,179],(function(){return t=48312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);